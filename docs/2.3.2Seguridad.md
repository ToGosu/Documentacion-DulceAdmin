### 2.3.2 Atributo de Calidad: Seguridad

El atributo **Seguridad** garantiza que el sistema *DulceAdmin* proteja los datos, usuarios y procesos de accesos indebidos, manteniendo la confidencialidad, integridad y disponibilidad de la información.  
Se aplican controles de autenticación, gestión de roles, auditoría y restricciones en operaciones críticas.

---

#### 2.3.2.1 Característica: Control de acceso por rol

Esta característica asegura que cada usuario tenga acceso únicamente a las funcionalidades correspondientes a su perfil (mesero, administrador o contador), evitando accesos no autorizados y protegiendo los recursos del sistema.

---

##### 2.3.2.1.1 Escenario: ESC-CAL-Seguridad-0001 – Visualización de funciones por rol

**Tipo:** Flujo básico  
**Objetivo:** Asegurar que el usuario solo acceda a funciones según su rol.  
**Descripción:** El sistema habilita módulos específicos para cada tipo de usuario tras autenticación.  
**Criterio de éxito:** Los usuarios visualizan únicamente las opciones de su perfil.  
**Fuente del estímulo:** Inicio de sesión.  
**Estímulo:** Usuario ingresa al sistema.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación y control de acceso.  
**Respuesta:** Se muestran únicamente los módulos habilitados por rol.  
**Medida de la respuesta:** 100% de restricciones aplicadas correctamente.  
**Táctica:** Gestión de roles y permisos.  
**Estrategia:** Definir niveles de acceso diferenciados por perfil de usuario.

**Interpretación técnica:**  
Implementa un control de acceso basado en roles (**RBAC**) para limitar la exposición de funcionalidades, reduciendo el riesgo de accesos indebidos.

---

##### 2.3.2.1.2 Escenario: ESC-CAL-Seguridad-0002 – Bloqueo de acceso por credenciales incorrectas

**Tipo:** Flujo alterno  
**Objetivo:** Impedir el acceso al sistema con credenciales no válidas.  
**Descripción:** Si un usuario introduce credenciales erróneas, el acceso es rechazado.  
**Criterio de éxito:** Usuario no autorizado no logra ingresar.  
**Fuente del estímulo:** Intento de inicio de sesión inválido.  
**Estímulo:** Credenciales incorrectas.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** Acceso denegado y mensaje de error mostrado.  
**Medida de la respuesta:** 100% de accesos inválidos rechazados.  
**Táctica:** Gestión de roles y permisos.  
**Estrategia:** Validar credenciales antes de iniciar sesión.  

**Interpretación técnica:**  
Evita ataques de fuerza bruta o accesos no deseados mediante validaciones estrictas de autenticación.

---

##### 2.3.2.1.3 Escenario: ESC-CAL-Seguridad-0003 – Cierre de sesión por inactividad

**Tipo:** Flujo alterno  
**Objetivo:** Cerrar sesión automáticamente tras inactividad.  
**Descripción:** El sistema detecta inactividad del usuario y cierra la sesión después de 5 minutos.  
**Criterio de éxito:** 100% de sesiones cerradas por inactividad.  
**Fuente del estímulo:** Usuario inactivo.  
**Estímulo:** No hay interacción con el sistema.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** Cierre automático de sesión.  
**Medida de la respuesta:** Tiempo máximo de inactividad ≤ 5 minutos.  
**Táctica:** Gestión de roles y permisos.  
**Estrategia:** Implementar temporizador de sesión automática.

**Interpretación técnica:**  
Este escenario previene accesos indebidos por sesiones abiertas, fortaleciendo la **seguridad física y lógica** del sistema.

---

##### 2.3.2.1.4 Escenario: ESC-CAL-Seguridad-0004 – Autenticación multifactor (MFA) para administradores

**Tipo:** Flujo alterno  
**Objetivo:** Aumentar la seguridad en accesos críticos.  
**Descripción:** El sistema solicita doble verificación (ej. código SMS) cuando un administrador accede a configuraciones sensibles.  
**Criterio de éxito:** 100% de accesos privilegiados verificados por MFA.  
**Fuente del estímulo:** Acceso de administrador.  
**Estímulo:** Intento de modificar configuraciones.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** Solicita validación adicional antes de permitir acceso.  
**Medida de la respuesta:** Cero accesos privilegiados sin MFA.  
**Táctica:** Gestión de roles y permisos.  
**Estrategia:** Aplicar autenticación multifactor en roles de alto nivel.

**Interpretación técnica:**  
Se fortalece la seguridad de las operaciones administrativas mediante un sistema de **verificación de múltiples factores** (MFA), mitigando riesgos por robo de credenciales.

---

##### 2.3.2.1.5 Escenario: ESC-CAL-Seguridad-0005 – Cierre de sesión automática de administrador inactivo

**Tipo:** Flujo alterno  
**Objetivo:** Proteger sesiones de alto privilegio ante abandono.  
**Descripción:** Si un administrador deja su sesión abierta, el sistema la cierra automáticamente tras 10 minutos.  
**Criterio de éxito:** 0% de operaciones indebidas por sesiones abiertas.  
**Fuente del estímulo:** Inactividad prolongada.  
**Estímulo:** Sesión de administrador inactiva.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación y gestión de sesiones.  
**Respuesta:** Cierre automático y solicitud de autenticación nueva.  
**Medida de la respuesta:** Tiempo máximo de inactividad ≤ 10 min.  
**Táctica:** Gestión de roles y permisos.  
**Estrategia:** Aplicar timeout en sesiones de privilegio.  

**Interpretación técnica:**  
Evita la **exposición accidental de sesiones privilegiadas**, reforzando la protección de información sensible.

---

#### 2.3.2.2 Característica: Inicio de sesión seguro

El sistema debe garantizar la autenticación confiable de los usuarios, controlando intentos de acceso fallidos y evitando ataques de fuerza bruta.

---

##### 2.3.2.2.1 Escenario: ESC-CAL-Seguridad-0006 – Inicio de sesión seguro

**Tipo:** Flujo básico  
**Objetivo:** Permitir acceso solo a usuarios autorizados.  
**Descripción:** El sistema requiere usuario y contraseña válidos para iniciar sesión.  
**Criterio de éxito:** 100% de accesos no autorizados rechazados.  
**Fuente del estímulo:** Necesidad de autenticación.  
**Estímulo:** Intento de inicio de sesión.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** Acceso concedido solo si las credenciales son correctas.  
**Medida de la respuesta:** 0% de accesos indebidos exitosos.  
**Táctica:** Inicio de sesión seguro.  
**Estrategia:** Aplicar validación robusta de credenciales.  

**Interpretación técnica:**  
Asegura la **identidad y legitimidad** de los usuarios mediante autenticación obligatoria y cifrado de credenciales.

---

##### 2.3.2.2.2 Escenario: ESC-CAL-Seguridad-0007 – Bloqueo por intentos fallidos

**Tipo:** Flujo alterno  
**Objetivo:** Prevenir ataques de fuerza bruta.  
**Descripción:** Si se ingresan más de 5 intentos fallidos, el sistema bloquea temporalmente la cuenta.  
**Criterio de éxito:** Bloqueo tras 5 intentos incorrectos.  
**Fuente del estímulo:** Intentos repetidos de inicio fallido.  
**Estímulo:** Acceso con credenciales inválidas múltiples veces.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** Cuenta bloqueada y alerta al administrador.  
**Medida de la respuesta:** Tiempo de bloqueo temporal establecido.  
**Táctica:** Bloqueo por intentos fallidos.  
**Estrategia:** Aplicar políticas de seguridad de acceso.  

**Interpretación técnica:**  
Protege el sistema contra **ataques automatizados**, estableciendo límites claros en intentos de autenticación fallidos.

---

#### 2.3.2.3 Característica: Control de acceso al inventario

---

##### 2.3.2.3.1 Escenario: ESC-CAL-Seguridad-0008 – Modificación restringida del inventario

**Tipo:** Flujo básico  
**Objetivo:** Permitir edición de inventario solo a administradores.  
**Descripción:** Los usuarios con rol administrador son los únicos con permisos para crear, editar o eliminar productos.  
**Criterio de éxito:** 100% de modificaciones realizadas solo por administradores.  
**Fuente del estímulo:** Intento de modificar inventario.  
**Estímulo:** Acción de edición o eliminación.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de inventario.  
**Respuesta:** Validación de permisos previa a cada acción.  
**Medida de la respuesta:** 0 cambios no autorizados.  
**Táctica:** Control de acceso a inventario.  
**Estrategia:** Validar permisos de rol antes de modificar inventario.  

**Interpretación técnica:**  
Garantiza la **integridad de los datos** del inventario mediante controles de permisos estrictos.

---

##### 2.3.2.3.2 Escenario: ESC-CAL-Seguridad-0009 – Notificación de intento no autorizado

**Tipo:** Flujo alterno  
**Objetivo:** Alertar sobre intentos indebidos de modificación.  
**Descripción:** Si un usuario sin privilegios intenta editar inventario, el sistema rechaza la acción y genera un registro.  
**Criterio de éxito:** 100% de intentos indebidos registrados y notificados.  
**Fuente del estímulo:** Usuario sin permisos.  
**Estímulo:** Intento de modificación no autorizado.  
**Ambiente:** Operación anómala.  
**Artefacto:** Módulo de inventario.  
**Respuesta:** Bloqueo de la acción y envío de alerta al administrador.  
**Medida de la respuesta:** Registro inmediato en log del sistema.  
**Táctica:** Notificación de intento no autorizado.  
**Estrategia:** Registrar y alertar sobre acciones indebidas.  

**Interpretación técnica:**  
Aumenta la **trazabilidad y visibilidad** de eventos sospechosos, útil para auditorías y detección de incidentes de seguridad.

---

#### 2.3.2.4 Característica: Restricciones de facturación y auditoría del sistema

Esta característica se centra en garantizar la integridad contable y la trazabilidad de las operaciones del sistema *DulceAdmin*. Incluye controles que impiden acciones indebidas sobre facturas y permiten la auditoría completa de los accesos de los usuarios.

---

##### 2.3.2.4.1 Escenario: ESC-CAL-Seguridad-0010 – Restricción de eliminación de facturas

**Tipo:** Flujo básico  
**Objetivo:** Evitar que usuarios no autorizados eliminen registros contables.  
**Descripción:** Solo los administradores pueden anular facturas; los meseros o cajeros no tienen permisos de eliminación.  
**Criterio de éxito:** 0 facturas eliminadas por usuarios sin rol administrativo.  
**Fuente del estímulo:** Intento de eliminación de factura.  
**Estímulo:** Acción de un usuario sin permisos.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de facturación.  
**Respuesta:** Acción bloqueada con mensaje de restricción.  
**Medida de la respuesta:** 100% de bloqueos ante intentos no autorizados.  
**Táctica:** Restricción de eliminación de facturas.  
**Estrategia:** Impedir que roles de nivel medio (mesero o cajero) eliminen registros financieros.  

**Interpretación técnica:**  
Se garantiza la **integridad contable del sistema**, evitando pérdidas de información o manipulaciones indebidas en los registros de facturación.

---

##### 2.3.2.4.2 Escenario: ESC-CAL-Seguridad-0011 – Anulación con registro de auditoría

**Tipo:** Flujo alterno  
**Objetivo:** Permitir la anulación controlada de facturas bajo registro.  
**Descripción:** El administrador puede anular facturas, las cuales quedan registradas con marca de “anulado” y trazabilidad completa.  
**Criterio de éxito:** 100% de anulaciones registradas en auditoría.  
**Fuente del estímulo:** Error de facturación.  
**Estímulo:** Solicitud de anulación.  
**Ambiente:** Operación excepcional.  
**Artefacto:** Módulo de facturación.  
**Respuesta:** La factura se marca como anulada sin ser eliminada.  
**Medida de la respuesta:** Registro persistente en el log del sistema.  
**Táctica:** Anulación con registro de auditoría.  
**Estrategia:** Permitir anulación controlada por administrador con registro permanente.  

**Interpretación técnica:**  
Este escenario garantiza **transparencia y trazabilidad** en operaciones sensibles. Toda anulación genera evidencia persistente, útil para auditorías internas o externas.

---

#### 2.3.2.5 Característica: Registro y trazabilidad de accesos

El sistema debe registrar cada intento de acceso, exitoso o fallido, con el fin de mantener un historial detallado para fines de auditoría, control y seguridad.

---

##### 2.3.2.5.1 Escenario: ESC-CAL-Seguridad-0012 – Registro de accesos exitosos

**Tipo:** Flujo básico  
**Objetivo:** Mantener historial completo de accesos al sistema.  
**Descripción:** Cada inicio de sesión exitoso se registra con usuario, fecha y hora.  
**Criterio de éxito:** 100% de accesos válidos registrados.  
**Fuente del estímulo:** Inicio de sesión.  
**Estímulo:** Usuario autorizado accede al sistema.  
**Ambiente:** Operación normal.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** Registro del evento en la base de datos.  
**Medida de la respuesta:** Registro auditado sin omisiones.  
**Táctica:** Registro de accesos.  
**Estrategia:** Almacenar historial de login en base de datos con marca temporal.  

**Interpretación técnica:**  
Permite la **auditoría detallada** de accesos, contribuyendo al monitoreo del comportamiento de usuarios y detección de anomalías.

---

##### 2.3.2.5.2 Escenario: ESC-CAL-Seguridad-0013 – Registro de intentos fallidos de inicio de sesión

**Tipo:** Flujo alterno  
**Objetivo:** Permitir el rastreo de intentos de acceso no autorizados.  
**Descripción:** Todos los intentos fallidos quedan registrados con dirección IP, hora y usuario ingresado.  
**Criterio de éxito:** 100% de intentos registrados.  
**Fuente del estímulo:** Intento de acceso fallido.  
**Estímulo:** Usuario ingresa credenciales incorrectas.  
**Ambiente:** Operación anómala.  
**Artefacto:** Módulo de autenticación.  
**Respuesta:** El sistema registra el evento y bloquea el acceso.  
**Medida de la respuesta:** Registro automático inmediato del evento.  
**Táctica:** Registro de intentos fallidos.  
**Estrategia:** Guardar en log los intentos de inicio fallidos con metadatos.  

**Interpretación técnica:**  
Fortalece la **seguridad proactiva** del sistema al detectar posibles ataques o intentos de intrusión, permitiendo acciones preventivas y análisis forense posterior.